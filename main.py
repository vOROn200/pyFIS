#!/usr/bin/env python3

import time
from lawo import SerialMONOMaster

DISPLAY_ADDRESS = int(0x05)
COMMAND_DELAY = 0.2


def main():

    bus = SerialMONOMaster(
        port="COM3",
        baudrate=19200,
        stopbits=2,
        debug=True,
    )

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_QUERY, [])

    time.sleep(COMMAND_DELAY)

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_PRE_BITMAP_FLIPDOT, [0x08, 0x04])

    time.sleep(COMMAND_DELAY)

    # ----- 24x13
    payload = [0x08] 
    # fmt: off -> 01111111 =7F -> 11111110 11111110 
    payload.extend([
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
    ])
    # fmt: on

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_COLUMN_DATA_FLIPDOT, payload)

    time.sleep(COMMAND_DELAY)
    # -----

    # -----
    payload = [0x07]
    # fmt: off
    payload.extend([
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00
    
    ])
    # fmt: on

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_COLUMN_DATA_FLIPDOT, payload)

    time.sleep(COMMAND_DELAY)
    # -----

    # -----
    payload = [0x06]
    # fmt: off
    payload.extend([
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00
    ])
    # fmt: on

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_COLUMN_DATA_FLIPDOT, payload)

    time.sleep(COMMAND_DELAY)
    # -----

    # -----
    payload = [0x05]
    # fmt: off
    payload.extend([
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x90, 0x00, 0x00,  0x00, 0x00, 0x00
    ])
    # fmt: on

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_COLUMN_DATA_FLIPDOT, payload)

    time.sleep(COMMAND_DELAY)
    # -----

    # -----
    # четная 
    payload = [0x04]
    # fmt: off
    payload.extend([
        0x10, 0xAA, 0xAA,  0xAA, 0xAA, 0xAA,
        0x10, 0xAA, 0xAA,  0xAA, 0xAA, 0xAA,
        0x10, 0xAA, 0xAA,  0xAA, 0xAA, 0xAA,
        0x10, 0xAA, 0xAA,  0xAA, 0xAA, 0xAA
    ])
    # fmt: on

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_COLUMN_DATA_FLIPDOT, payload)

    time.sleep(COMMAND_DELAY)
    # -----

    # -----
    payload = [0x03]
    # fmt: off
    payload.extend([
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00
    ])
    # fmt: on

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_COLUMN_DATA_FLIPDOT, payload)

    time.sleep(COMMAND_DELAY)
    # -----    
    
    # -----
    payload = [0x02]
    # fmt: off
    payload.extend([
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00
    ])
    # fmt: on

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_COLUMN_DATA_FLIPDOT, payload)

    time.sleep(COMMAND_DELAY)
    # -----


    # -----
    payload = [0x01]
    # fmt: off
    payload.extend([
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00,
        0x10, 0x00, 0x00,  0x00, 0x00, 0x00
    ])
    # fmt: on

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_COLUMN_DATA_FLIPDOT, payload)

    time.sleep(COMMAND_DELAY)
    # -----

    bus.send_command(DISPLAY_ADDRESS, bus.CMD_QUERY, [])


if __name__ == "__main__":
    main()
